# üó∫Ô∏è Roadmap: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –°—Ç—Ä–æ–π–Ω–æ—Å—Ç—å" (v4.0)

**–¶–µ–ª—å:** –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ C-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –º–æ–¥—É–ª—å–Ω—ã–π –¥–≤–∏–∂–æ–∫, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π –¥–∞–Ω–Ω—ã–º–∏.

## üèóÔ∏è Phase 1: –°—Ç—Ä–æ–≥–∞—è –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (The Facade Pattern)
*–¶–µ–ª—å: –§–∏–∑–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.*

- [x] **–†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è `src/engine/graphics`**
    - [x] **Flattening:** –§–∞–π–ª—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (`stream.c`, `gpu_input.c`, `compute_graph.c`) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –º–æ–¥—É–ª—è.
    - [x] **Internal:**
        - [x] `internal/backend/` ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±—ç–∫–µ–Ω–¥ (Vulkan).
        - [x] `internal/render_system_internal.h` ‚Äî —Å–∫—Ä—ã—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RenderSystem.
        - [x] `internal/stream_internal.h` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ–∂–¥—É Stream –∏ Backend.
    - [x] **Cleanup:** –°–æ–∑–¥–∞–Ω—ã `graphics_types.h` –∏ –≤—ã–¥–µ–ª–µ–Ω `gpu_input.h`. –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ö–µ–¥–µ—Ä—ã (`layer_constants.h`, `render_batch.h`).
- [x] **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `engine/assets`**
    - [x] –†–∞–∑–±–∏—Ç—å `assets.c` –Ω–∞ —Ñ–∞—Å–∞–¥ (–≤ –∫–æ—Ä–Ω–µ) –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é:
        - [x] –ó–∞–≥—Ä—É–∑–∫–∞: `internal/asset_loader.c`
        - [x] –•—Ä–∞–Ω–µ–Ω–∏–µ: `internal/asset_storage.c`
- [x] **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ Opaque Pointers (PIMPL)**
    - [x] –í –ø—É–±–ª–∏—á–Ω—ã—Ö —Ö–µ–¥–µ—Ä–∞—Ö (`render_system.h`) –æ—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ typedefs.
    - [x] –ü–æ–ª–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ `internal/render_system_internal.h`.

## üîå Phase 2: –†–∞–∑—Ä—ã–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Decoupling)
*–¶–µ–ª—å: –†–µ–Ω–¥–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –ø—Ä–æ UI, –∞ –Ø–¥—Ä–æ –ø—Ä–æ –ú–∞—Ç–µ–º–∞—Ç–∏–∫—É.*

- [x] **Render Agnosticism (–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä–∞)**
    - [x] **Unified Geometry Stream:** –°–æ–∑–¥–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º `PrimitiveBatcher` –¥–ª—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤ (–ª–∏–Ω–∏–∏, –∫–≤–∞–¥—ã) –∏–∑ –ª—é–±–æ–π –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã (UI, Wires, Gizmos).
    - [x] **Fix UI & Wire Rendering:**
        - [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `ui_renderer.c`: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ `pipeline_id` –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞.
        - [x] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç—Ä–∏—Å–æ–≤–∫—É —Å–≤—è–∑–µ–π (Wires) —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π `PrimitiveBatcher`.
    - [x] –£–¥–∞–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `render_system` –æ—Ç `ui_node.h`.
    - [x] **–ó–∞–¥–∞—á–∞:** –ú–æ–¥—É–ª—å UI –¥–æ–ª–∂–µ–Ω —Å–∞–º –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ (`RenderBatch`). –†–µ–Ω–¥–µ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "—Ç—É–ø—ã–º" –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º.
- [x] **Feature System (Plugin Architecture)**
    - [x] –í–≤–µ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `EngineFeature` (–º–µ—Ç–æ–¥—ã `on_init`, `on_update`, `on_extract`).
    - [x] –£–¥–∞–ª–∏—Ç—å –ø—Ä—è–º–æ–π –∏–Ω–∫–ª—é–¥ `math_editor.h` –∏–∑ `engine.c`.
    - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é `MathEditor` –≤ `main.c` –∫–∞–∫ –ø–ª–∞–≥–∏–Ω–∞.

## üìú Phase 3: –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–µ –Ø–¥—Ä–æ (Data-Driven Core)
*–¶–µ–ª—å: –ó–∞–º–µ–Ω–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ –≤ `render_system` –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–π –ø–∞–π–ø–ª–∞–π–Ω.*

- [x] **1. –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Runtime Representation)**
    - [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã GDL –≤ C-–∫–æ–¥–µ:
        - `PipelineResourceDef` (–æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤: —Ç–µ–∫—Å—Ç—É—Ä—ã, –±—É—Ñ–µ—Ä—ã).
        - `PipelinePassDef` (–∏–º—è –ø—Ä–æ—Ö–æ–¥–∞, —à–µ–π–¥–µ—Ä—ã, inputs/outputs, —Ç–µ–≥–∏ draw_list).
        - `PipelineDefinition` (–æ–±—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).
- [x] **2. –†–µ–µ—Å—Ç—Ä –ü—Ä–æ—Ö–æ–¥–æ–≤ (Pass Registry)**
    - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–ª–±—ç–∫–æ–≤: `render_system_register_pass("Name", callback)`.
    - [x] –°–≤—è–∑–∞—Ç—å —Å–∏—Å—Ç–µ–º—ã (UI, Scene, Math) —Å —Ä–µ–µ—Å—Ç—Ä–æ–º, —á—Ç–æ–±—ã –æ–Ω–∏ "—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏" —Å–≤–æ–∏ –ø—Ä–æ—Ö–æ–¥—ã.
- [x] **3. Pipeline Loader**
    - [x] –ù–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä—Å–µ—Ä `pipeline_loader.c`, —á–∏—Ç–∞—é—â–∏–π YAML –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã GDL.
    - [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Ä–µ—Å—É—Ä—Å–æ–≤, –Ω–∞–ª–∏—á–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ö–æ–¥–æ–≤).
- [x] **4. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (The Executor)**
    - [x] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `render_system_draw`:
        - –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É –ø—Ä–æ—Ö–æ–¥–æ–≤ (`passes`) –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
        - –ü–æ–∏—Å–∫ C-—Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ä–µ–µ—Å—Ç—Ä–µ –ø–æ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ö–æ–¥–∞.
        - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Framebuffer/Attachments –Ω–∞ –æ—Å–Ω–æ–≤–µ `outputs`.
        - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è `RenderBatch` –ø–æ —Ç–µ–≥–∞–º –∏ –≤—ã–∑–æ–≤ –∫–æ–ª–±—ç–∫–∞.
- [ ] **5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –†–µ—Å—É—Ä—Å–∞–º–∏ (Transient Resources)**
    - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `VkImage`/`VkBuffer` –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã—Ö –≤ —Å–µ–∫—Ü–∏–∏ `resources`.
    - [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º (—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, —Ä–µ—Å–∞–π–∑ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–∫–Ω–∞).

## üßπ Phase 4: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –î–æ–ª–≥ –ë—ç–∫–µ–Ω–¥–∞
*–¶–µ–ª—å: –°–¥–µ–ª–∞—Ç—å Vulkan-–±—ç–∫–µ–Ω–¥ —á–∏—â–µ.*

- [ ] **Dynamic Descriptor Layouts**
    - [ ] –£–±—Ä–∞—Ç—å –∂–µ—Å—Ç–∫–æ –∑–∞—à–∏—Ç—ã–µ –∏–Ω–¥–µ–∫—Å—ã —Å–µ—Ç–æ–≤ (Set 0, Set 1) –≤ `vk_pipeline.c`.
    - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ª–µ–π–∞—É—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ —à–µ–π–¥–µ—Ä–æ–≤ –∏–ª–∏ GDL.
- [ ] **Buffer Management**
    - [ ] –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ `Stream` –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å –±—É—Ñ–µ—Ä–∞–º–∏.
    - [ ] –£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –≤—ã–∑–æ–≤—ã `vk_buffer_create` –∏–∑ –ª–æ–≥–∏–∫–∏ —Å—Ü–µ–Ω—ã.
    