# Roadmap: Refactoring v3.0 (The Great Decoupling)

–ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å: –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å Core-—Å–ª–æ–π –≤ "—Ç—É–ø–æ–≥–æ" –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∫–æ–º–∞–Ω–¥ –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ UI –∏ 3D/Compute.

## üõ†Ô∏è Phase 1: Renderer Backend Cleanup (Command Buffer)
*–¶–µ–ª—å: –£–±—Ä–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `Scene*` –≤ `vulkan_renderer.c`.*

- [x] **–°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `RenderCommandList`** (–≤ `engine/graphics`)
    - [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø—ã –∫–æ–º–∞–Ω–¥: `CMD_BIND_PIPELINE`, `CMD_BIND_BUFFER`, `CMD_DRAW`, `CMD_DRAW_INDIRECT`.
    - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–∏–Ω–µ–π–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∏ –≥—Ä–∞—Ñ–∞ —Å—Ü–µ–Ω—ã.
- [x] **–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `vulkan_renderer_render_scene`**
    - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ `RenderCommandList`.
    - [x] –¢—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–≤–∏–∂–∫–∞ –≤ –≤—ã–∑–æ–≤—ã `vkCmd*`.
- [x] **–í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É Math Node**
    - [x] –£–±—Ä–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –¥–ª—è Math Nodes –ª–æ–≥–∏–∫—É (–±–∏–Ω–¥–∏–Ω–≥ SSBO –ø–æ —É—Å–ª–æ–≤–∏—é) –∏–∑ –±—ç–∫–µ–Ω–¥–∞.
    - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–º–∞–Ω–¥ `CMD_BIND_BUFFER` / `CMD_DRAW` –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ `MathRenderSystem`.

## üì¶ Phase 2: Data Separation
*–¶–µ–ª—å: –†–∞–∑–¥–µ–ª–∏—Ç—å `SceneObject` –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.*

- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `UiNode`** (–≤ `engine/ui`)
    - [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: Layout (x,y,w,h), Style, Flags.
    - [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ (Parent/Child).
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `RenderBatch`** (–¥–ª—è –ì—Ä–∞—Ñ–∞ –∏ 3D)
    - [ ] –ü–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–±–µ–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏).
    - [ ] –°–æ—Å—Ç–∞–≤: `PipelineID`, `BindGroup` (—Ä–µ—Å—É—Ä—Å—ã), `DrawParams`.
- [ ] **–û—á–∏—Å—Ç–∏—Ç—å `render_packet.h`**
    - [ ] –£–¥–∞–ª–∏—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π `union` (SceneObject).
    - [ ] –†–∞–∑–¥–µ–ª–∏—Ç—å –ø–∞–∫–µ—Ç –Ω–∞ –¥–≤–∞ —Å–ø–∏—Å–∫–∞: `UiCmds` (–¥–ª—è UI) –∏ `RenderBatches` (–¥–ª—è —Å—Ü–µ–Ω—ã).

## ‚ö° Phase 3: Compute Unification
*–¶–µ–ª—å: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —à–µ–π–¥–µ—Ä–æ–≤.*

- [ ] **–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è `ComputePass`**
    - [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤ –≤ `RenderSystem`.
- [ ] **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏**
    - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `render_system_register_compute(graph)`.
    - [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å `MathEditor` –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–≤–æ–µ–≥–æ –≥—Ä–∞—Ñ–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
- [ ] **–¶–∏–∫–ª –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è**
    - [ ] –í—ã–∑—ã–≤–∞—Ç—å `compute_graph_execute` –¥–ª—è –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤ –≤ –Ω–∞—á–∞–ª–µ –∫–∞–¥—Ä–∞.
- [ ] **–û—á–∏—Å—Ç–∫–∞ `RenderSystem`**
    - [ ] –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–µ `active_compute_pipeline`.
    - [ ] –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–µ `show_compute_result`.

## üßπ Phase 4: Cleanup & Optimization
*–¶–µ–ª—å: –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.*

- [ ] **Refactor `scene_loader.c`**
    - [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `src/foundation/meta/reflection.h`.
    - [ ] –ó–∞–º–µ–Ω–∏—Ç—å —Ä—É—á–Ω–æ–π —Ä–∞–∑–±–æ—Ä –ø–æ–ª–µ–π –Ω–∞ `meta_set_from_string`.
- [ ] **Unify Buffer Management**
    - [ ] –°–¥–µ–ª–∞—Ç—å `Stream` –æ—Å–Ω–æ–≤–Ω—ã–º –≤–ª–∞–¥–µ–ª—å—Ü–µ–º GPU-–±—É—Ñ–µ—Ä–æ–≤.
    - [ ] –ù–∞—É—á–∏—Ç—å –±—ç–∫–µ–Ω–¥ –ø—Ä–∏–Ω–∏–º–∞—Ç—å `Stream*` –Ω–∞–ø—Ä—è–º—É—é.
    - [ ] –£–¥–∞–ª–∏—Ç—å/–°–ø—Ä—è—Ç–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–±–µ—Ä—Ç–∫–∏ `VkBufferWrapper`.

---

## üîÆ Backlog / Future Ideas (Post-v3.0)
*Status: Experimental / Unscheduled*

- [ ] **Distributed Compute**: –ó–∞–ø—É—Å–∫ Macro Graph –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö GPU –∏–ª–∏ –º–∞—à–∏–Ω–∞—Ö.
- [ ] **WebGPU Export**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è WGSL –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ WASM.
- [ ] **AI-Assisted Graph Gen**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–∫—Ä–æ-–≥—Ä–∞—Ñ–æ–≤ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é ("Copilot").
- [ ] **Package Manager (`gpm`)**: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –Ω–æ–¥.